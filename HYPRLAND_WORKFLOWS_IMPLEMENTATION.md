# Hyprland Workflows - Implementation Complete âœ…

Complete workflow system for Hyprland with HyDE integration.

## ğŸ“Š What Was Built

### Core System
- **Workflow Module** (`workflows/workflows.nix`) - Main Home Manager module
- **Workflow Switcher** (`scripts/workflow-switcher.nix`) - CLI tool for switching
- **Integration** - Modified existing config files to integrate workflows

### Presets from HyDE

#### ğŸ¬ Animations (19 presets)
All as individual `.nix` files in `presets/animations/`:
- classic, diablo-1, diablo-2, disable, dynamic
- end4, fast, high, ja, lime-frenzy
- me-1, me-2, minimal-1, minimal-2, moving
- optimized, standard, theme, vertical

#### ğŸ¨ Shaders (10 shaders)
Organized in `presets/shaders/`:
- `shaders.nix` - Main module exporting all shader presets
- `_shaderfiles/` - Directory with actual GLSL files copied from HyDE
  - blue-light-filter.frag
  - color-vision.frag
  - custom.frag
  - disable.frag
  - grayscale.frag
  - invert-colors.frag
  - oled-saver.frag
  - paper.frag
  - vibrance.frag
  - wallbash.frag

### Why Shaders Are Different

**Animations**: Keep as `.nix` files because they're just Nix data structures (bezier curves and timing).

**Shaders**: Use actual `.frag` GLSL files because:
- âœ… Easy to copy new shaders from HyDE or other sources
- âœ… Can edit shaders directly without Nix escaping
- âœ… Syntax highlighting works in editors
- âœ… Can include custom `.inc` files for user customization
- âœ… Single `shaders.nix` references all shader files

## ğŸ—‚ï¸ File Structure

```
modules/desktop/environment/hyprland/
â”œâ”€â”€ workflows/
â”‚   â”œâ”€â”€ workflows.nix          # Main workflow module
â”‚   â””â”€â”€ README.md             # Documentation
â”œâ”€â”€ presets/
â”‚   â”œâ”€â”€ animations/           # 19 .nix files
â”‚   â”‚   â”œâ”€â”€ classic.nix
â”‚   â”‚   â”œâ”€â”€ fast.nix
â”‚   â”‚   â””â”€â”€ ... (17 more)
â”‚   â””â”€â”€ shaders/
â”‚       â”œâ”€â”€ shaders.nix       # Single module for all shaders
â”‚       â”œâ”€â”€ README.md        # Shader documentation
â”‚       â””â”€â”€ _shaderfiles/    # Actual GLSL files
â”‚           â”œâ”€â”€ blue-light-filter.frag
â”‚           â”œâ”€â”€ grayscale.frag
â”‚           â””â”€â”€ ... (8 more)
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ run-or-raise.nix
â”‚   â””â”€â”€ workflow-switcher.nix # Workflow switching script
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ binds.nix            # Added $mod+W keybinding
â”‚   â”œâ”€â”€ settings.nix         # Added workflow notes
â”‚   â”œâ”€â”€ monitors.nix
â”‚   â””â”€â”€ rules.nix
â””â”€â”€ hyprland.nix             # Includes workflows aspect

Generated at runtime:
~/.config/hypr/
â”œâ”€â”€ profiles/               # Generated by Home Manager
â”‚   â”œâ”€â”€ default.conf
â”‚   â”œâ”€â”€ gaming.conf
â”‚   â””â”€â”€ ...
â””â”€â”€ profile.conf           # Symlink to active profile
```

## ğŸš€ Usage

### 1. Enable in Your Config

In your Home Manager configuration (e.g., `users/cody/cody.nix`):

```nix
wayland.windowManager.hyprland.workflows = {
  enable = true;
  
  profiles = [
    {
      name = "default";
      animation = "optimized";
      shader = null;
      settings = {
        decoration = {
          blur.enabled = true;
          rounding = 10;
        };
        general = {
          gaps_in = 3;
          gaps_out = 5;
        };
      };
    }
    {
      name = "gaming";
      animation = "disable";
      shader = null;
      settings = {
        decoration = {
          blur.enabled = false;
          rounding = 0;
        };
        general = {
          gaps_in = 0;
          gaps_out = 0;
        };
      };
    }
    {
      name = "coding";
      animation = "fast";
      shader = "blue-light-filter";
      settings = {
        decoration = {
          blur.enabled = false;
          rounding = 5;
        };
        general = {
          gaps_in = 5;
          gaps_out = 8;
          border_size = 2;
        };
      };
    }
    {
      name = "music-production";
      animation = "minimal-1";
      shader = null;
      settings = {
        misc.vfr = false;  # Fixed FPS for audio
      };
    }
  ];
};
```

### 2. Rebuild

```bash
nh home switch
# or
home-manager switch --flake .
```

### 3. Switch Workflows

```bash
# Interactive with walker (keybind: $mod + W)
hyprland-workflow-switcher --select walker

# Direct switch
hyprland-workflow-switcher --set gaming

# Check current
hyprland-workflow-switcher --get-current

# Reset to default
hyprland-workflow-switcher --reset
```

## ğŸ¨ Adding New Shaders

Just drop a new `.frag` file in `_shaderfiles/` and add it to `shaders.nix`:

```nix
# In presets/shaders/shaders.nix
my-new-shader = {
  description = "My awesome shader";
  settings = {
    decoration = {
      screen_shader = "${./_shaderfiles/my-shader.frag}";
    };
  };
};
```

No need to escape strings or deal with Nix heredocs!

## ğŸ“ Customizing Shader Parameters

Create `.inc` files in `~/.config/hypr/shaders/`:

```glsl
// ~/.config/hypr/shaders/blue-light-filter.inc
#define BLUE_LIGHT_FILTER_TEMPERATURE 4000.0
#define BLUE_LIGHT_FILTER_INTENSITY 0.7
```

The shader will automatically include it.

## ğŸ¯ Key Features

âœ… **19 Animation Presets** from HyDE  
âœ… **10 Shader Presets** from HyDE  
âœ… **Declarative Configuration** - All in Nix  
âœ… **Easy Shader Management** - Just copy `.frag` files  
âœ… **Composable Workflows** - Mix animations + shaders + settings  
âœ… **Fast Switching** - Instant workflow changes  
âœ… **Walker Integration** - Beautiful menu ($mod + W)  
âœ… **User Customization** - Override shader params with `.inc` files  

## ğŸ“š Documentation

- `workflows/README.md` - Workflow system documentation
- `presets/shaders/README.md` - Shader documentation with all parameters

## âš ï¸ Important Notes

1. **One `default` workflow required**
2. **All workflow names must be unique**
3. **Settings in `config/settings.nix` override workflow settings**
4. **First load may show error** - run switcher once to initialize
5. **Hyprland auto-reloads** when switching workflows

## ğŸ‰ Success!

Your Hyprland workflow system is ready with:
- 19 animation styles
- 10 shader effects
- Easy to extend with more shaders
- Fully declarative in Nix
- Direct GLSL file support

Happy workflow switching! ğŸš€
